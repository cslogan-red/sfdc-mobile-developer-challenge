function showLoading(e){if(e!=null&&e){$j.mobile.loading("show",{text:"Processing...",textVisible:true,theme:"b",html:""})}else{$j.mobile.loading("show")}}function initGlobals(){global_DialogId=null;global_SelectedObject=null;global_InitNextPage=0;global_InitPrevPage=-1;global_PickListObject=null}function hideAddressBar(){if(mobileDetect("android")){var e=window.outerHeight/window.devicePixelRatio+"px";document.documentElement.style.height=e;$j(".pages").css("height",e);window.scrollTo(1,1)}}function mobileDetect(){var e=navigator.userAgent.toLowerCase();var t=false;for(var n=0;n<arguments.length;n++){if(e.search(arguments[n].toLowerCase())>=0){t=true;break}}return t}function previousPage(){if($j.mobile.activePage.attr("id")==="optionspage"){$j.mobile.changePage("#mainpage",{changeHash:true,transition:"slide",reverse:true})}else if($j.mobile.activePage.attr("id")==="objectdetailpagedialog"){if($j("#currentobjectoptionselection").text()===global_SelectedObject){$j.mobile.changePage("#objectdetailpage",{changeHash:true,transition:"pop",reverse:true})}else{$j.mobile.changePage("#mainpage",{changeHash:true,transition:"pop",reverse:true})}}else if($j.mobile.activePage.attr("id")==="objectdetailpage"){$j.mobile.changePage("#optionspage",{changeHash:true,transition:"slide",reverse:true})}else if($j.mobile.activePage.attr("id")==="graphpage"){$j.mobile.changePage("#optionspage",{changeHash:true,transition:"slide",reverse:true})}}function showSalesOptions(e){var t=["Leads","Opportunities","Customers","Tasks","Cases","Help"];var n=1;$j.each(t,function(e,t){var r="#choice"+n;$j(r).empty();$j("<button></button>").attr({id:e,"class":"salesbutton",value:"","data-inline":"true","data-shadow":"true"}).hide().click(function(e){e.preventDefault();showLoading(true);$j("#optionslist").hide();var n=function(){$j.mobile.changePage("#optionspage",{changeHash:true});$j("#optionspage").trigger("create");$j("#optionslist").show();$j.mobile.loading("hide")};showObjectOptions(t,n)}).appendTo(r).show();$j('<p class="buttonTitle">'+t+"</p>").appendTo(r);n++});if(e!=null){e()}}function getNotifications(e){MobileController.getNotifications(function(t,n){showNotifications(t,e)})}function showNotifications(e,t){$j("#popupPanel").empty();$j("<p>Notifications</p>").appendTo("#popupPanel");if(e!=null&&e.length>0){$j.each(e,function(e,t){var n=new Date(t.ActivityDate);n.setTime(t.ActivityDate+n.getTimezoneOffset()*6e4);refValue=t.Subject+" - "+n.toDateString();$j("<input></input>").attr({type:"button",value:refValue,"data-theme":"a","data-mini":true}).hide().click(function(e){e.preventDefault();global_DialogId=t.Id;showLoading(true);$j("#dialoglist").hide();showObjectOptions("Tasks",function(){$j.mobile.loadPage("#optionspage",{showLoadMsg:false});$j("#optionspage").trigger("create");getObjectDetailData(function(){$j.mobile.loadPage("#objectdetailpage",{showLoadMsg:false});$j("#objectDetailListOrdered").listview("refresh");$j("#objectDetailListUnordered").listview("refresh");getObjectDetailDialogData(function(){$j.mobile.changePage("#objectdetailpagedialog",{changeHash:true});$j("#objectdetailpagedialog").trigger("create");$j("#dialoglist").show();$j.mobile.loading("hide")})})})}).appendTo("#popupPanel").show()})}$j("<input></input>").attr({type:"button",value:"Refresh","data-theme":"b","data-mini":true,"data-inline":true}).hide().click(function(e){showLoading(true);e.preventDefault();getNotifications(function(){$j("#mainpage").trigger("create");$j.mobile.loading("hide")})}).appendTo("#popupPanel").show();if(t!=null){t()}}function showObjectOptions(e,t){var n;$j("#optionslist").empty();$j("#optionsbuttons").empty();global_SelectedObject=e;if(e=="Leads"||e=="Opportunities"){var r=null;var i=null;$j("#currentoptionselection").text(e);$j("<h3>Tap a button to make a selection:</h3>").appendTo("#optionslist");n=[e+" By Product of Interest"];$j("<input></input>").attr({type:"button",value:n,"class":"optionsbutton","data-icon":"arrow-r","data-iconpos":"right"}).hide().click(function(e){e.preventDefault();$j.mobile.changePage("#graphpage",{changeHash:true});$j("#graphlist").hide();showLoading(true);var t=function(){$j.mobile.loading("hide")};getGraphData(t,r,i)}).appendTo("#optionsbuttons").show();n=["My "+e];$j("<input></input>").attr({type:"button",value:n,"class":"optionsbutton","data-icon":"arrow-r","data-iconpos":"right"}).hide().click(function(e){e.preventDefault();showLoading(true);var t=function(){$j.mobile.changePage("#objectdetailpage",{changeHash:true});$j("#objectDetailListOrdered").listview("refresh");$j("#objectDetailListUnordered").listview("refresh");$j.mobile.loading("hide")};getObjectDetailData(t)}).appendTo("#optionsbuttons").show();if(e=="Leads"){$j("<input></input>").attr({type:"button",value:"Create New Lead","class":"optionsbutton","data-icon":"arrow-r","data-iconpos":"right"}).hide().click(function(e){e.preventDefault();showLoading(true);if(global_PickListObject==null){global_DialogId=null;getObjectDetailDialogData(function(){$j.mobile.changePage("#objectdetailpagedialog",{changeHash:true});$j("#objectdetailpagedialog").trigger("create");$j.mobile.loading("hide")})}else{createNewLead(function(){$j.mobile.changePage("#objectdetailpagedialog",{changeHash:true});$j("#objectdetailpagedialog").trigger("create");$j.mobile.loading("hide")})}}).appendTo("#optionsbuttons").show()}}else if(e=="Tasks"){$j("#currentoptionselection").text(e);$j("<h3>Tap a button to make a selection:</h3>").appendTo("#optionslist");n=["My "+e];$j("<input></input>").attr({type:"button",value:n,"class":"optionsbutton","data-icon":"arrow-r","data-iconpos":"right"}).hide().click(function(e){e.preventDefault();showLoading(true);var t=function(){$j.mobile.changePage("#objectdetailpage",{changeHash:true});$j("#objectDetailListOrdered").listview("refresh");$j("#objectDetailListUnordered").listview("refresh");$j.mobile.loading("hide")};getObjectDetailData(t)}).appendTo("#optionsbuttons").show()}else if(e=="Cases"||e=="Customers"){$j("#currentoptionselection").text(e);if(e=="Cases"){$j("<h3>Find Cases</h3>").appendTo("#optionslist");$j("<label>Search By Case Number:</label>").attr({"for":"casenumbersearch"}).appendTo("#optionslist");$j("<input></input>").attr({type:"search",name:"searchcase",id:"casenumbersearch",value:"",onkeyup:"eventKeyHandler(event)"}).appendTo("#optionslist");$j("<br></br>").appendTo("#optionslist");$j("<label>Search By Case Owner or Queue Name:</label>").attr({"for":"caseownersearch"}).appendTo("#optionslist");$j("<input></input>").attr({type:"search",name:"searchcaseowner",id:"caseownersearch",value:"",onkeyup:"eventKeyHandler(event)"}).appendTo("#optionslist");$j("<br></br>").appendTo("#optionslist");$j("<br></br>").appendTo("#optionslist");$j("<input></input>").attr({type:"button",id:"casesearchbutton",value:"Search","data-icon":"search","data-inline":"true"}).click(function(e){e.preventDefault();showLoading(true);var t=function(){$j.mobile.changePage("#objectdetailpage",{changeHash:true});$j("#objectDetailListOrdered").listview("refresh");$j("#objectDetailListUnordered").listview("refresh");$j.mobile.loading("hide")};executeCaseSearch(t)}).appendTo("#optionslist").button().button("refresh")}else{$j("<h3>Find Customers</h3>").appendTo("#optionslist");$j("<label>Search By Membership Number:</label>").attr({"for":"membernumbersearch"}).appendTo("#optionslist");$j("<input></input>").attr({type:"search",name:"searchmembernumber",id:"membernumbersearch",value:"",onkeyup:"eventKeyHandler(event)"}).appendTo("#optionslist");$j("<br></br>").appendTo("#optionslist");$j("<label>Search By Customer Name:</label>").attr({"for":"customernamesearch"}).appendTo("#optionslist");$j("<input></input>").attr({type:"search",name:"searchcustomername",id:"customernamesearch",value:"",onkeyup:"eventKeyHandler(event)"}).appendTo("#optionslist");$j("<br></br>").appendTo("#optionslist");$j("<br></br>").appendTo("#optionslist");$j("<input></input>").attr({type:"button",id:"customersearchbutton",value:"Search","data-icon":"search","data-inline":"true"}).click(function(e){e.preventDefault();showLoading(true);var t=function(){$j.mobile.changePage("#objectdetailpage",{changeHash:true});$j("#objectDetailListOrdered").listview("refresh");$j("#objectDetailListUnordered").listview("refresh");$j.mobile.loading("hide")};executeCustomerSearch(t)}).appendTo("#optionslist").button().button("refresh")}}else if(e=="Help"){$j("#currentoptionselection").text(e);$j("<h3>Help Topics:</h3>").appendTo("#optionslist");$j("<div></div>").attr({id:"helpset","data-role":"collapsible-set"}).html('<div data-role="collapsible">'+"<h3>About</h3>"+"<ul><li>mobileAgent is designed to give you quick access to the information you need most in Salesforce.</li><hr/>"+"<li>By default, all screens start by showing only the items YOU own.</li><hr/>"+"<li>Use the search functionality to look up items assigned to other users and queues.</li><hr/></ul></div>"+'<div data-role="collapsible">'+"<h3>Navigation</h3>"+"<ul><li>Navigate between screens by touching the icons and buttons provided.</li><hr/>"+"<li>Swipe your finger to the right on any screen to go back to the previous screen.</li><hr/>"+'<li>Tap the "Home" button from any screen to go back to the home screen.</li><hr/></ul></div>'+'<div data-role="collapsible">'+"<h3>Search</h3>"+"<li>Search for Cases and Customers by using the provided search inputs.</li><hr/>"+"<li>Case number and owner searches can be any length (not case sensitive) and the closest matche(s) will be returned.</li><hr/>"+"<li>Customer name and membership number searches can be any length (not case sensitive) and the closest matche(s) will be returned.</li><hr/>"+'<li>The "Product of Interest" graph allows you to search for Leads and Opportunities assigned to any user or queue (exact match required, not case sensitive).</li><hr/></ul></div>').appendTo("#optionslist")}if(t!=null){t()}}function getGraphData(e,t,n){if(global_SelectedObject!=null&&t!="none"){var r=global_SelectedObject;MobileController.queryObjectForGraph(r,t,n,function(t,n){showGraphData(t,e)},{escape:true})}else{records=null;showGraphData(records,e)}}function showGraphData(e,t){var n;var r={};r.autoCount=0;r.homeCount=0;r.lifeCount=0;r.membershipCount=0;r.earthquakeCount=0;$j("#chartdiv").empty();var i=global_SelectedObject;$j("#currentgraphselection").text(i);if(e!=null&&e.length>0){for(var s=0;s<e.length;s++){if(e[s].Product_of_Interest__c==="Auto"){r.autoCount++}else if(e[s].Product_of_Interest__c==="Homeowners"){r.homeCount++}else if(e[s].Product_of_Interest__c==="Life"){r.lifeCount++}else if(e[s].Product_of_Interest__c==="Membership"){r.membershipCount++}else if(e[s].Product_of_Interest__c==="Earthquake"){r.earthquakeCount++}}var o=e[0].Owner.Name;$j("#currentuser").html("Current User: "+o);if(window.innerHeight>window.innerWidth){n=["Auto","Home..","Life","Mem..","Ear.."]}else{n=["Auto","Homeowners","Life","Membership","Earthquake"]}$j("#graphlist").show();$j("#chartdiv").show();$j.jqplot.config.enablePlugins=true;var u=$j.jqplot("chartdiv",[[r.autoCount,r.homeCount,r.lifeCount,r.membershipCount,r.earthquakeCount]],{captureRightClick:true,seriesColors:i=="Leads"?["#00FFFF"]:["#DC143C"],title:i+" by Product of Interest",seriesDefaults:{renderer:$j.jqplot.BarRenderer,rendererOptions:{highlightMouseDown:true},pointLabels:{show:true}},axes:{xaxis:{renderer:$j.jqplot.CategoryAxisRenderer,ticks:n,tickOptions:{showGridline:false}},yaxis:{tickOptions:{show:false,formatString:"%d"}}},grid:{background:"#004E78",borderColor:"#FFFFFF",borderWidth:3},highlighter:{show:false}})}else{$j("#graphlist").show();$j("#chartdiv").hide();$j("#currentuser").text("No data exists for selected user and timeframe!");$j.mobile.changePage("#graphpage",{changeHash:true,transition:"none",allowSamePageTransition:true})}if(t!=null){t()}}function getGraphObjectDetailData(e,t,n){if(global_SelectedObject!=null){var r=global_SelectedObject;MobileController.queryGraphObject(r,t,n,function(n,r){global_InitNextPage=0;global_InitPrevPage=-1;showObjectDetailData(n,t,0,e)},{escape:true})}else{records=null;global_InitNextPage=0;global_InitPrevPage=-1;showObjectDetailData(records,t,0,e)}}function getObjectDetailData(e){var t=null;if(global_SelectedObject!=null){var n=global_SelectedObject;MobileController.queryObject(n,function(n,r){global_InitNextPage=0;global_InitPrevPage=-1;showObjectDetailData(n,t,0,e)},{escape:true})}else{records=null;global_InitNextPage=0;global_InitPrevPage=-1;showObjectDetailData(records,t,0,e)}}function showObjectDetailData(e,t,n,r){var s;var o=global_SelectedObject;var u=[];var a=e!=null&&e.length>0?String(e.length):0;var f;$j("#objectDetailListOrdered").empty();$j("#objectDetailListUnordered").empty();$j("#currentobjectoptionsubtitle").remove();$j("#currentobjectoptionselection").text(o);if(e!=null&&e.length>0){if(n!=null){if(e.length>=PAGE_LENGTH&&parseInt(a.charAt(0))>n){u=new Array(PAGE_LENGTH)}else if(e.length>PAGE_LENGTH&&parseInt(a.charAt(0))==n&&parseInt(a.charAt(1))<PAGE_LENGTH){u=new Array(parseInt(a.charAt(1)))}else if(e.length<PAGE_LENGTH){u=new Array(parseInt(a.charAt(0)));disablePageButtons()}if(u.length==PAGE_LENGTH){for(i=n*PAGE_LENGTH;i<n*PAGE_LENGTH+PAGE_LENGTH;i++){u[i-n*PAGE_LENGTH]=e[i]}}else{for(i=n*PAGE_LENGTH;i<n*PAGE_LENGTH+u.length;i++){u[i-n*PAGE_LENGTH]=e[i]}}}else{u=e}$j.each(u,function(r,i){var u=i.Id;if(i.Name!=null&&u.indexOf(LEAD)==0){$j("#currentobjectoptiontitle").text(t!=null?"Open "+t+" "+o:"My "+o);s=i.Name+" - "+(i.Product_of_Interest__c!=null?i.Product_of_Interest__c:"No POI Available");if(f==null){f=i.Name.charAt(0)}else{if(f.toLowerCase()!=i.Name.charAt(0).toLowerCase()){f=i.Name.charAt(0)}}if(!$j("#divider"+f).length){var l="divider"+f;$j('<li data-role="list-divider">'+f.toUpperCase()+"</li>").attr({id:l}).hide().appendTo("#objectDetailListUnordered").show()}var c;if(i.Product_of_Interest__c!=null&&i.Product_of_Interest__c=="Membership"){c='<img class="membership"/>'}else if(i.Product_of_Interest__c!=null&&i.Product_of_Interest__c=="Homeowners"){c='<img class="home"/>'}else if(i.Product_of_Interest__c!=null&&i.Product_of_Interest__c=="Auto"){c='<img class="auto"/>'}else if(i.Product_of_Interest__c!=null&&i.Product_of_Interest__c=="Personal Umbrella (PUP)"){c='<img class="pup"/>'}else{c='<img class="other"/>'}$j('<li><a data-icon="arrow-r" >'+c+s+"</a></li>").attr({id:r}).hide().click(function(e){e.preventDefault();global_DialogId=i.Id;showLoading(true);$j("#dialoglist").hide();getObjectDetailDialogData(function(){$j.mobile.changePage("#objectdetailpagedialog",{changeHash:true});$j("#objectdetailpagedialog").trigger("create");$j("#dialoglist").show();$j.mobile.loading("hide")})}).appendTo("#objectDetailListUnordered").show()}else if(i.Name!=null&&u.indexOf(OPPTY)==0){$j("#currentobjectoptiontitle").text(t!=null?"Open "+t+" "+o:"My "+o);s=i.Name;if(f==null){f=i.Name.charAt(0)}else{if(f.toLowerCase()!=i.Name.charAt(0).toLowerCase()){f=i.Name.charAt(0)}}if(!$j("#divider"+f).length){var l="divider"+f;$j('<li data-role="list-divider">'+f.toUpperCase()+"</li>").attr({id:l}).hide().appendTo("#objectDetailListUnordered").show()}var c;if(i.Product_of_Interest__c!=null&&i.Product_of_Interest__c=="Membership"){c='<img class="membership"/>'}else if(i.Product_of_Interest__c!=null&&i.Product_of_Interest__c=="Homeowners"){c='<img class="home"/>'}else if(i.Product_of_Interest__c!=null&&i.Product_of_Interest__c=="Auto"){c='<img class="auto"/>'}else if(i.Product_of_Interest__c!=null&&i.Product_of_Interest__c=="Personal Umbrella (PUP)"){c='<img class="pup"/>'}else{c='<img class="other"/>'}$j('<li><a data-icon="arrow-r">'+c+s+"</a></li>").attr({id:r}).hide().click(function(e){e.preventDefault();global_DialogId=i.Id;showLoading(true);$j("#dialoglist").hide();getObjectDetailDialogData(function(){$j.mobile.changePage("#objectdetailpagedialog",{changeHash:true});$j("#objectdetailpagedialog").trigger("create");$j("#dialoglist").show();$j.mobile.loading("hide")})}).appendTo("#objectDetailListUnordered").show()}else if(i.Subject!=null&&u.indexOf(TASK)==0){$j("#currentobjectoptiontitle").text("My "+o);var h=new Date(i.ActivityDate);h.setTime(i.ActivityDate+h.getTimezoneOffset()*6e4);s=i.Subject+" - "+h.toDateString();$j("<li></li>").attr({"data-role":"list-divider"}).hide().append("Due Date: "+h.toDateString()).appendTo("#objectDetailListUnordered").show();$j("<li></li>").attr({id:r}).hide().html('<a data-icon="arrow-r">'+"<h3>"+i.Subject+"</h3>"+"<p>"+(i.Description!=null?i.Description:"No description provided.")+"</p>"+'<p class="ui-li-aside">'+i.Status+"</p>"+"</a>").click(function(e){e.preventDefault();global_DialogId=i.Id;showLoading(true);$j("#dialoglist").hide();getObjectDetailDialogData(function(){$j.mobile.changePage("#objectdetailpagedialog",{changeHash:true});$j("#objectdetailpagedialog").trigger("create");$j("#dialoglist").show();$j.mobile.loading("hide")})}).appendTo("#objectDetailListUnordered").show()}else if(i.CaseNumber!=null&&u.indexOf(CASE)==0){$j("#currentobjectoptiontitle").text("Case Search Results");s="Case #: "+i.CaseNumber+" - "+i.Account.Name;if(f==null){f=i.Account.Name.charAt(0)}else{if(f.toLowerCase()!=i.Account.Name.charAt(0).toLowerCase()){f=i.Account.Name.charAt(0)}}if(!$j("#divider"+f).length){var l="divider"+f;$j('<li data-role="list-divider">'+f.toUpperCase()+"</li>").attr({id:l}).hide().appendTo("#objectDetailListUnordered").show()}$j('<li><a data-icon="arrow-r">'+s+"</a></li>").attr({id:r}).hide().click(function(e){e.preventDefault();global_DialogId=i.Id;showLoading(true);$j("#dialoglist").hide();getObjectDetailDialogData(function(){$j.mobile.changePage("#objectdetailpagedialog",{changeHash:true});$j("#objectdetailpagedialog").trigger("create");$j("#dialoglist").show();$j.mobile.loading("hide")})}).appendTo("#objectDetailListUnordered").show()}else if(i.Name!=null&&u.indexOf(CUST)==0){$j("#currentobjectoptiontitle").text("Customer Search Results");var p=EMPTY_VAL;if(i.Preferred_Method_of_Contact__pc!=null&&i.Preferred_Method_of_Contact__pc!=""){if(i.Preferred_Method_of_Contact__pc=="Home"){p=i.Home_Phone__c}else if(i.Preferred_Method_of_Contact__pc=="Mobile"){p=i.PersonMobilePhone}else if(i.Preferred_Method_of_Contact__pc=="Work"){p=i.Work_Phone__pc}}s=i.Name+" - "+(p!=EMPTY_VAL?p:"Phone Not Available");if(f==null){f=i.Name.charAt(0)}else{if(f.toLowerCase()!=i.Name.charAt(0).toLowerCase()){f=i.Name.charAt(0)}}if(!$j("#divider"+f).length){var l="divider"+f;$j('<li data-role="list-divider">'+f.toUpperCase()+"</li>").attr({id:l}).hide().appendTo("#objectDetailListUnordered").show()}$j('<li><a data-icon="arrow-r">'+s+"</a></li>").attr({id:r}).hide().click(function(e){e.preventDefault();global_DialogId=i.Id;showLoading(true);$j("#dialoglist").hide();getObjectDetailDialogData(function(){$j.mobile.changePage("#objectdetailpagedialog",{changeHash:true});$j("#objectdetailpagedialog").trigger("create");$j("#dialoglist").show();$j.mobile.loading("hide")})}).appendTo("#objectDetailListUnordered").show()}if(r==9&&e.length>PAGE_LENGTH&&parseInt(a.charAt(0))>n){paginate(e,t);return false}return true})}else{if(o=="Cases"){$j("#currentobjectoptiontitle").text("Case Search Results")}else if(o=="Customers"){$j("#currentobjectoptiontitle").text("Customer Search Results")}else{$j("#currentobjectoptiontitle").text("")}$j("#currentobjectoptionsubtitle").remove();$j("<p></p>").text("No "+o+" found.").attr("id","currentobjectoptionsubtitle").insertAfter("#currentobjectoptiontitle");disablePageButtons()}if(r!=null){r()}}function getPickVals(e){if(global_PickListObject==null){MobileController.getPickListVals(function(e,t){global_PickListObject={};global_PickListObject.leadsPOIVals=e.leadPOI;global_PickListObject.leadsStatus=e.leadStatus;global_PickListObject.leadsCallBackPhoneType=e.leadCallBackPhoneType;global_PickListObject.opptysPOIVals=e.opptyPOI;global_PickListObject.opptysStatus=e.opptyStatus;global_PickListObject.customersCallBackPhoneType=e.customerCallBackPhoneType;global_PickListObject.tasksStatus=e.taskStatus;global_PickListObject.tasksPriority=e.taskPriority;global_PickListObject.tasksType=e.taskType},{escape:true})}if(e!=null){e()}}function getObjectDetailDialogData(e){if(global_DialogId!=null){getPickVals(function(){var t=global_SelectedObject;MobileController.queryObjectDetails(t,global_DialogId,function(t,n){showObjectDetailDialogData(t,"display",e)},{escape:true})})}else{getPickVals(function(){MobileController.getCurrentUser(function(t,n){createNewLead(e)},{escape:true})})}}function showObjectDetailDialogData(e,t,n){var r;var i=global_SelectedObject;$j("#currentobjectdetailselection").text(i);$j("#productsowned").empty();if(e!=null&&t!=null&&t==="display"){$j.each(e,function(t,n){var i=n.Id;if(n.Name!=null&&i.indexOf(LEAD)==0){r=n.Name+" - "+(n.Product_of_Interest__c!=null?n.Product_of_Interest__c:"No POI Available");var s=EMPTY_VAL;if(n.Call_Back_Phone_Type__c!=null&&n.Call_Back_Phone_Type__c!=""){if(n.Call_Back_Phone_Type__c=="Home"){s=n.Home_Phone__c}else if(n.Call_Back_Phone_Type__c=="Mobile"){s=n.MobilePhone}else if(n.Call_Back_Phone_Type__c=="Work"){s=n.Work_Phone__c}}$j("#currentobjectdetailtitle").text(r);$j("#dialogdetails").html('<div data-role="collapsible-set" class="collapsibleContent">'+'<div data-role="collapsible" data-collapsed="false">'+"<h3>Lead Details</h3>"+"<p>Current Owner: "+(n.Owner.Name!=null?n.Owner.Name:EMPTY_VAL)+"</p><hr/>"+"<p>Product of Interest: "+(n.Product_of_Interest__c!=null?n.Product_of_Interest__c:EMPTY_VAL)+"</p><hr/>"+"<p>Lead Status: "+(n.Status!=null?n.Status:EMPTY_VAL)+"</p><hr/>"+"<p>Lead Source: "+(n.LeadSource!=null?n.LeadSource:EMPTY_VAL)+"</p><hr/>"+"<p>"+(s!=EMPTY_VAL?"Contact Phone: <a href='tel:"+s+"'>"+s+"</a>":"Contact Phone: "+EMPTY_VAL)+"</p><hr/></div>"+'<div data-role="collapsible" id="leadActions">'+"<h3>Lead Actions</h3>"+"</div></div>");$j("<button></button>").attr({value:"Edit","data-inline":"true","data-mini":"true","class":"dialogbutton"}).click(function(t){showLoading(true);showObjectDetailDialogData(e,"edit",function(){$j.mobile.changePage("#objectdetailpagedialog",{changeHash:true,transition:"none",allowSamePageTransition:true});$j("#objectdetailpagedialog").trigger("create");$j.mobile.loading("hide")})}).appendTo("#leadActions");$j("<button></button>").attr({value:"Convert","data-inline":"true","data-mini":"true","class":"dialogbutton"}).click(function(e){showLoading(true);modifyObject("lead","convert",null,n,function(e){$j.mobile.changePage("#objectconfirmationdialog",{changeHash:true});$j.mobile.loading("hide")})}).appendTo("#leadActions");$j("<button></button>").attr({value:"Delete","data-inline":"true","data-mini":"true","class":"dialogbutton"}).click(function(e){showLoading(true);modifyObject("lead","delete",null,n,function(e){$j.mobile.changePage("#objectconfirmationdialog",{changeHash:true});$j.mobile.loading("hide")})}).appendTo("#leadActions");$j("<button></button>").attr({value:"Create Task","data-inline":"true","data-mini":"true","class":"dialogbutton"}).click(function(e){showLoading(true);createNewTask(n.Id,function(e){$j.mobile.changePage("#objectdetailpagedialog",{changeHash:true,transition:"none",allowSamePageTransition:true});$j.mobile.loading("hide")})}).appendTo("#leadActions");$j("#dialogdetails").addClass("dialogdetaillines");$j("#objectdetailpagedialog").trigger("create")}else if(n.Name!=null&&i.indexOf(OPPTY)==0){r=n.Name;$j("#currentobjectdetailtitle").text(r);$j("#dialogdetails").html('<div data-role="collapsible-set" class="collapsibleContent">'+'<div data-role="collapsible" data-collapsed="false">'+"<h3>Opportunity Details</h3>"+"<p>Current Owner: "+(n.Owner.Name!=null?n.Owner.Name:EMPTY_VAL)+"</p><hr/>"+"<p>Product of Interest: "+(n.Product_of_Interest__c!=null?n.Product_of_Interest__c:EMPTY_VAL)+"</p><hr/>"+"<p>Opportunity Status: "+(n.StageName!=null?n.StageName:EMPTY_VAL)+"</p><hr/>"+"<p>Quoted Amount: "+(n.Amount!=null?n.Amount:EMPTY_VAL)+"</p><hr/>"+"<p>Quoted Product: "+(n.Actual_Product_Name__c!=null?n.Actual_Product_Name__c:EMPTY_VAL)+"</p><hr/></div>"+'<div data-role="collapsible" id="opptyActions">'+"<h3>Opportunity Actions</h3>"+"</div></div>");$j("<button></button>").attr({value:"View Customer","data-inline":"true","data-mini":"true","class":"dialogbutton"}).click(function(t){showLoading(true);getOpportunityCustomer(e,function(){$j.mobile.changePage("#objectdetailpagedialog",{changeHash:true,transition:"none",allowSamePageTransition:true});$j("#objectdetailpagedialog").trigger("create");$j.mobile.loading("hide")})}).appendTo("#opptyActions");$j("<button></button>").attr({value:"Create Task","data-inline":"true","data-mini":"true","class":"dialogbutton"}).click(function(e){showLoading(true);createNewTask(n.Id,function(e){$j.mobile.changePage("#objectdetailpagedialog",{changeHash:true,transition:"none",allowSamePageTransition:true});$j.mobile.loading("hide")})}).appendTo("#opptyActions");$j("#dialogdetails").addClass("dialogdetaillines");$j("#objectdetailpagedialog").trigger("create")}else if(n.Subject!=null&&i.indexOf(TASK)==0){var o=new Date(n.ActivityDate);o.setTime(n.ActivityDate+o.getTimezoneOffset()*6e4);r="Due: "+o.toDateString();$j("#currentobjectdetailtitle").text(r);$j("#dialogdetails").html('<div data-role="collapsible-set" class="collapsibleContent">'+'<div data-role="collapsible" data-collapsed="false">'+"<h3>Task Details</h3>"+"<p>Staus: "+(n.Status!=null?n.Status:EMPTY_VAL)+"</p><hr/>"+"<p>Subject: "+(n.Subject!=null?n.Subject:EMPTY_VAL)+"</p><hr/>"+"<p>Type: "+(n.Type!=null?n.Type:EMPTY_VAL)+"</p><hr/>"+"<p>Priority: "+(n.Priority!=null?n.Priority:EMPTY_VAL)+"</p><hr/>"+"<p>Comments: "+(n.Description!=null?n.Description:EMPTY_VAL)+"</p><hr/></div>"+'<div data-role="collapsible" id="taskActions">'+"<h3>Task Actions</h3>"+"</div></div>");$j("<button></button>").attr({value:"Edit","data-inline":"true","data-mini":"true","class":"dialogbutton"}).click(function(t){showLoading(true);showObjectDetailDialogData(e,"edit",function(){$j.mobile.changePage("#objectdetailpagedialog",{changeHash:true,transition:"none",allowSamePageTransition:true});$j("#objectdetailpagedialog").trigger("create");$j.mobile.loading("hide")})}).appendTo("#taskActions");$j("#dialogdetails").addClass("dialogdetaillines");$j("#objectdetailpagedialog").trigger("create")}else if(n.CaseNumber!=null&&i.indexOf(CASE)==0){var o=new Date(n.CreatedDate);o.setTime(n.CreatedDate+o.getTimezoneOffset()*6e4);r=n.CaseNumber+" - "+n.Account.Name;$j("#currentobjectdetailtitle").text(r);$j("#dialogdetails").html('<div data-role="collapsible-set" class="collapsibleContent">'+'<div data-role="collapsible" data-collapsed="false">'+"<h3>Case Details</h3>"+"<p>Case Number: "+(n.CaseNumber!=null?n.CaseNumber:EMPTY_VAL)+"</p><hr/>"+"<p>Staus: "+(n.Status!=null?n.Status:EMPTY_VAL)+"</p><hr/>"+"<p>Owner: "+(n.Owner.Name!=null?n.Owner.Name:EMPTY_VAL)+"</p><hr/>"+"<p>Created: "+o.toDateString()+"</p><hr/>"+"<p>For Customer: "+(n.Account.Name!=null?n.Account.Name:EMPTY_VAL)+"</p><hr/></div></div>");$j("#dialogdetails").addClass("dialogdetaillines")}else if(n.Name!=null&&i.indexOf(CUST)==0){var s=EMPTY_VAL;if(n.Preferred_Method_of_Contact__pc!=null&&n.Preferred_Method_of_Contact__pc!=""){if(n.Preferred_Method_of_Contact__pc=="Home"){s=n.Home_Phone__c}else if(n.Preferred_Method_of_Contact__pc=="Mobile"){s=n.PersonMobilePhone}else if(n.Preferred_Method_of_Contact__pc=="Work"){s=n.Work_Phone__pc}}r=n.Name+" - "+(s!=EMPTY_VAL?s:"Phone Not Available");$j("#currentobjectdetailtitle").text(r);var u;if(n.Member_Since__pc!=null){var o=new Date(n.Member_Since__pc);o.setTime(o.getTime()+o.getTimezoneOffset()*6e4);u=o.toDateString()}else{u=EMPTY_VAL;}$j("#dialogdetails").html('<div data-role="collapsible-set" class="collapsibleContent">'+'<div data-role="collapsible" data-collapsed="false">'+"<h3>Customer Details</h3>"+"<p>Membership Number: "+(n.Membership_Number__pc!=null?n.Membership_Number__pc:EMPTY_VAL)+"</p><hr/>"+"<p>Member Since: "+u+"</p><hr/>"+"<p>"+(s!=EMPTY_VAL?"Contact Phone: <a href='tel:"+s+"'>"+s+"</a>":"Contact Phone: "+EMPTY_VAL)+"</p><hr/>"+"<p>"+(n.Primary_Email__pc!=null?"Email: <a href='mailto:"+n.Primary_Email__pc+"'>"+n.Primary_Email__pc+"</a>":"Email: "+EMPTY_VAL)+"</p><hr/>"+"<p>"+(n.Address__pc!=null?"Address: <a href='http://maps.google.com/maps?q="+escape(n.Address__pc)+"'>"+n.Address__pc+"</a>":"Address: "+EMPTY_VAL)+"</p><hr/></div>"+'<div data-role="collapsible">'+"<h3>Products Owned</h3>"+'<div id="productsowned" class="ui-grid-c">'+'<div class="ui-block-a" id="product1"></div>'+'<div class="ui-block-b" id="product2"></div>'+'<div class="ui-block-c" id="product3"></div>'+'<div class="ui-block-d" id="product4"></div>'+"</div></div>"+'<div data-role="collapsible" id="customerActions">'+"<h3>Customer Actions</h3>"+"</div></div>");$j("<button></button>").attr({value:"Edit","data-inline":"true","data-mini":"true","class":"dialogbutton"}).click(function(t){showLoading(true);showObjectDetailDialogData(e,"edit",function(){$j.mobile.changePage("#objectdetailpagedialog",{changeHash:true,transition:"none",allowSamePageTransition:true});$j("#objectdetailpagedialog").trigger("create");$j.mobile.loading("hide")})}).appendTo("#customerActions");$j("<button></button>").attr({value:"View Opportunities","data-inline":"true","data-mini":"true","class":"dialogbutton"}).click(function(t){showLoading(true);getCustomerOpportunityData(e,function(){$j.mobile.changePage("#objectdetailpage",{changeHash:true});$j("#objectDetailListOrdered").listview("refresh");$j("#objectDetailListUnordered").listview("refresh");$j.mobile.loading("hide")})}).appendTo("#customerActions");$j("#dialogdetails").addClass("dialogdetaillines");$j("#objectdetailpagedialog").trigger("create");var a=1;var f=n.Membership__pc=="Active"?'<img class="activeMembership" height="40" width="40">':"<a href=\"#objectconfirmationdialog\" onClick=\"setConfirmationText('membership','"+n.Name+'\')"><img class="inactiveMembership" height="40" width="40"></a>';$j("#product"+a).html(f);a++;f=n.Auto__pc=="Active"?'<img class="activeAuto" width="40">':"<a href=\"#objectconfirmationdialog\" onClick=\"setConfirmationText('auto','"+n.Name+'\')"><img class="inactiveAuto" height="40" width="40"></a>';$j("#product"+a).html(f);a++;f=n.Home__pc=="Active"?'<img class="activeHome" height="40" width="40">':"<a href=\"#objectconfirmationdialog\" onClick=\"setConfirmationText('home','"+n.Name+'\')"><img class="inactiveHome" height="40" width="40"></a>';$j("#product"+a).html(f);a++;f=n.Personal_Umbrella__pc=="Active"?'<img class="activePUP" height="40" width="40">':"<a href=\"#objectconfirmationdialog\" onClick=\"setConfirmationText('pup','"+n.Name+'\')"><img class="inactivePUP" height="40" width="40"></a>';$j("#product"+a).html(f);a++}})}else if(e!=null&&t!=null&&t==="edit"){$j(".ui-dialog-contain").css("margin","10% auto 30% auto");$j.each(e,function(t,n){var i=n.Id;if(n.Name!=null&&i.indexOf(LEAD)==0){if(global_PickListObject!=null){var s="";for(t=0;t<global_PickListObject.leadsPOIVals.length;t++){s=s+'<option value="'+global_PickListObject.leadsPOIVals[t]+'" '+(n.Product_of_Interest__c!=null&&n.Product_of_Interest__c==global_PickListObject.leadsPOIVals[t]?'selected="selected">':">")+global_PickListObject.leadsPOIVals[t]+"</option>"}var o="";for(t=0;t<global_PickListObject.leadsStatus.length;t++){o=o+'<option value="'+global_PickListObject.leadsStatus[t]+'" '+(n.Status!=null&&n.Status==global_PickListObject.leadsStatus[t]?'selected="selected">':">")+global_PickListObject.leadsStatus[t]+"</option>"}var u="";for(t=0;t<global_PickListObject.leadsCallBackPhoneType.length;t++){u=u+'<option value="'+global_PickListObject.leadsCallBackPhoneType[t]+'" '+(n.Call_Back_Phone_Type__c!=null&&n.Call_Back_Phone_Type__c==global_PickListObject.leadsCallBackPhoneType[t]?'selected="selected">':">")+global_PickListObject.leadsCallBackPhoneType[t]+"</option>"}}r=n.Name+" - "+(n.Product_of_Interest__c!=null?n.Product_of_Interest__c:"No POI Available");$j("#currentobjectdetailtitle").text(r);$j("#dialogdetails").html('<div data-role="collapsible-set" class="collapsibleContent">'+'<div data-role="collapsible" data-collapsed="false">'+"<h3>Lead Details</h3>"+"<p>Current Owner: "+(n.Owner.Name!=null?n.Owner.Name:"")+"</p><hr/>"+'<p><label for="select-LeadPOI" class="select">Product of Interest:</label><select name="select-LeadPOI" id="select-LeadPOI" class="selectMenu">'+s+"</select></p><hr/>"+'<p><label for="select-LeadStatus" class="select">Lead Status:</label><select name="select-LeadStatus" id="select-LeadStatus" class="selectMenu">'+o+"</select></p><hr/>"+'<p><label for="select-LeadContactPhoneType" class="select">Callback Phone Type:</label><select name="select-LeadContactPhoneType" id="select-LeadContactPhoneType" class="selectMenu">'+u+"</select></p><hr/>"+'<p><label for="text-LeadHomePhone">Home Phone:</label><input type="tel" name="text-LeadHomePhone" id="text-LeadHomePhone" class="textInput" onkeyup="formatPhone(event)" value="'+(n.Home_Phone__c!=null?n.Home_Phone__c:"")+'"/></p><hr/>'+'<p><label for="text-LeadWorkPhone">Work Phone:</label><input type="tel" name="text-LeadWorkPhone" id="text-LeadWorkPhone" class="textInput" onkeyup="formatPhone(event)" value="'+(n.Work_Phone__c!=null?n.Work_Phone__c:"")+'"/></p><hr/>'+'<p><label for="text-LeadMobilePhone">Mobile Phone:</label><input type="tel" name="text-LeadMobilePhone" id="text-LeadMobilePhone" class="textInput" onkeyup="formatPhone(event)" value="'+(n.MobilePhone!=null?n.MobilePhone:"")+'"/></p><hr/></div>'+"</div>");$j("<button></button>").attr({value:"Save","data-inline":"true","class":"dialogbutton"}).click(function(e){showLoading(true);var t={};t.Product_of_Interest__c=$j("#select-LeadPOI").val()!=null&&$j("#select-LeadPOI").val()!=""?$j("#select-LeadPOI").val():null;t.Status=$j("#select-LeadStatus").val()!=null&&$j("#select-LeadStatus").val()!=""?$j("#select-LeadStatus").val():null;t.Call_Back_Phone_Type__c=$j("#select-LeadContactPhoneType").val()!=null&&$j("#select-LeadContactPhoneType").val()!=""?$j("#select-LeadContactPhoneType").val():null;t.Home_Phone__c=$j("#text-LeadHomePhone").val()!=null&&$j("#text-LeadHomePhone").val()!=""?$j("#text-LeadHomePhone").val():null;t.Work_Phone__c=$j("#text-LeadWorkPhone").val()!=null&&$j("#text-LeadWorkPhone").val()!=""?$j("#text-LeadWorkPhone").val():null;t.MobilePhone=$j("#text-LeadMobilePhone").val()!=null&&$j("#text-LeadMobilePhone").val()!=""?$j("#text-LeadMobilePhone").val():null;t.Id=n.Id;modifyObject("lead","edit",null,t,function(){global_DialogId=n.Id;getObjectDetailDialogData(function(){$j("#objectdetailpagedialog").trigger("create");$j.mobile.loading("hide")})})}).appendTo("#dialogdetails")}else if(n.Subject!=null&&i.indexOf(TASK)==0){if(global_PickListObject!=null){var a="";for(t=0;t<global_PickListObject.tasksType.length;t++){a=a+'<option value="'+global_PickListObject.tasksType[t]+'" >'+global_PickListObject.tasksType[t]+"</option>"}var o="";for(t=0;t<global_PickListObject.tasksStatus.length;t++){o=o+'<option value="'+global_PickListObject.tasksStatus[t]+'" >'+global_PickListObject.tasksStatus[t]+"</option>"}var f="";for(t=0;t<global_PickListObject.tasksPriority.length;t++){f=f+'<option value="'+global_PickListObject.tasksPriority[t]+'" >'+global_PickListObject.tasksPriority[t]+"</option>"}}var l=new Date(n.ActivityDate);l.setTime(n.ActivityDate+l.getTimezoneOffset()*6e4);r="Due: "+l.toDateString();var c=l.getMonth()+1;var h=c<10?"0"+c.toString()+"/"+l.getDate().toString()+"/"+l.getFullYear().toString():c.toString()+"/"+l.getDate().toString()+"/"+l.getFullYear().toString();var p;$j("#currentobjectdetailtitle").text(r);$j("#dialogdetails").html('<div data-role="collapsible-set" class="collapsibleContent">'+'<div data-role="collapsible" data-collapsed="false">'+"<h3>Task Details</h3>"+'<p><label for="text-TaskSubject" id="label-text-TaskSubject">Subject:</label><input type="text" name="text-TaskSubject" id="text-TaskSubject" class="textInput" value="'+(n.Subject!=null?n.Subject:"")+'"/></p><hr/>'+'<p><label for="select-TaskType" class="select" id="label-select-TaskType">Type:</label><select name="select-TaskType" id="select-TaskType" class="selectMenu">'+a+"</select></p><hr/>"+'<p><label for="select-TaskStatus" class="select" id="label-select-TaskStatus">Status:</label><select name="select-TaskStatus" id="select-TaskStatus" class="selectMenu">'+o+"</select></p><hr/>"+'<p><label for="select-TaskPriority" class="select" id="label-select-TaskPriority">Priority:</label><select name="select-TaskPriority" id="select-TaskPriority" class="selectMenu">'+f+"</select></p><hr/>"+'<p><label for="text-TaskDate" id="label-text-TaskDate">Due Date: (MM/DD/YYYY)</label><input type="text" name="text-TaskDate" id="text-TaskDate" class="textInput" maxlength="10" value="'+(h!=null?h:"")+'"/></input></p><hr/>'+'<p><label for="text-TaskDescription">Comments:</label><textarea name="text-TaskDescription" id="text-TaskDescription" class="textInput">'+(n.Description!=null?n.Description:"")+"</textarea></p><hr/></div></div>");$j("<button></button>").attr({value:"Save","data-inline":"true","class":"dialogbutton"}).click(function(e){showLoading(true);var t={};if($j("#text-TaskSubject").val()==null||$j("#text-TaskSubject").val()==""){$j("#label-text-TaskSubject").css("color","red");$j("#label-text-TaskSubject").text("Subject: *Required");$j("#text-TaskSubject").focus();$j.mobile.loading("hide");return false}else{$j("#label-text-TaskSubject").css("color","black");$j("#label-text-TaskSubject").text("Subject:");t.Subject=$j("#text-TaskSubject").val()}if($j("#select-TaskType").val()==null||$j("#select-TaskType").val()==""){$j("#label-select-TaskType").css("color","red");$j("#label-select-TaskType").text("Type: *Required");$j("#select-TaskType").focus();$j.mobile.loading("hide");return false}else{$j("#label-select-TaskType").css("color","black");$j("#label-select-TaskType").text("Type:");t.Type=$j("#select-TaskType").val()}if($j("#select-TaskStatus").val()==null||$j("#select-TaskStatus").val()==""){$j("#label-select-TaskStatus").css("color","red");$j("#label-select-TaskStatus").text("Status: *Required");$j("#select-TaskStatus").focus();$j.mobile.loading("hide");return false}else{$j("#label-select-TaskStatus").css("color","black");$j("#label-select-TaskStatus").text("Status:");t.Status=$j("#select-TaskStatus").val()}if($j("#select-TaskPriority").val()==null||$j("#select-TaskPriority").val()==""){$j("#label-select-TaskPriority").css("color","red");$j("#label-select-TaskPriority").text("Priority: *Required");$j("#select-TaskPriority").focus();$j.mobile.loading("hide");return false}else{$j("#label-select-TaskPriority").css("color","black");$j("#label-select-TaskPriority").text("Priority:");t.Priority=$j("#select-TaskPriority").val()}if(!validDate($j("#text-TaskDate").val())){$j("#label-text-TaskDate").css("color","red");$j("#label-text-TaskDate").text("Due Date: *Invalid Date, Required");$j("#text-TaskDate").focus();$j.mobile.loading("hide");return false}else{$j("#label-text-TaskDate").css("color","black");$j("#label-text-TaskDate").text("Date:");p=$j("#text-TaskDate").val()}t.Description=$j("#text-TaskDescription").val()!=null&&$j("#text-TaskDescription").val()!=""?$j("#text-TaskDescription").val():null;t.Id=n.Id;modifyObject("task","edit",p,t,function(){getObjectDetailData(function(){$j("#objectDetailListOrdered").listview("refresh");$j("#objectDetailListUnordered").listview("refresh");global_DialogId=n.Id;getObjectDetailDialogData(function(){$j("#objectdetailpagedialog").trigger("create");$j.mobile.loading("hide")})})});return true}).appendTo("#dialogdetails")}else if(n.Name!=null&&i.indexOf(CUST)==0){if(global_PickListObject!=null){var u="";for(t=0;t<global_PickListObject.customersCallBackPhoneType.length;t++){u=u+'<option value="'+global_PickListObject.customersCallBackPhoneType[t]+'" '+(n.Preferred_Method_of_Contact__pc!=null&&n.Preferred_Method_of_Contact__pc==global_PickListObject.customersCallBackPhoneType[t]?'selected="selected">':">")+global_PickListObject.customersCallBackPhoneType[t]+"</option>"}}var d=EMPTY_VAL;if(n.Preferred_Method_of_Contact__pc!=null&&n.Preferred_Method_of_Contact__pc!=""){if(n.Preferred_Method_of_Contact__pc=="Home"){d=n.Home_Phone__c}else if(n.Preferred_Method_of_Contact__pc=="Mobile"){d=n.PersonMobilePhone}else if(n.Preferred_Method_of_Contact__pc=="Work"){d=n.Work_Phone__pc}}r=n.Name+" - "+(d!=EMPTY_VAL?d:"Phone Not Available");$j("#currentobjectdetailtitle").text(r);$j("#dialogdetails").html('<div data-role="collapsible-set" class="collapsibleContent">'+'<div data-role="collapsible" data-collapsed="false">'+"<h3>Customer Details</h3>"+'<p><label for="text-CustomerEmail">Primary Email:</label><input type="text" name="text-CustomerEmail" id="text-CustomerEmail" class="textInput" value="'+(n.Primary_Email__pc!=null?n.Primary_Email__pc:"")+'"/></p><hr/>'+'<p><label for="select-CustomerContactPhoneType" class="select">Callback Phone Type:</label><select name="select-CustomerContactPhoneType" id="select-CustomerContactPhoneType" class="selectMenu">'+u+"</select></p><hr/>"+'<p><label for="text-CustomerHomePhone">Home Phone:</label><input type="tel" name="text-CustomerHomePhone" id="text-CustomerHomePhone" class="textInput" onkeyup="formatPhone(event)" value="'+(n.Home_Phone__c!=null?n.Home_Phone__c:"")+'"/></p><hr/>'+'<p><label for="text-CustomerWorkPhone">Work Phone:</label><input type="tel" name="text-CustomerWorkPhone" id="text-CustomerWorkPhone" class="textInput" onkeyup="formatPhone(event)" value="'+(n.Work_Phone__pc!=null?n.Work_Phone__pc:"")+'"/></p><hr/>'+'<p><label for="text-CustomerMobilePhone">Mobile Phone:</label><input type="tel" name="text-CustomerMobilePhone" id="text-CustomerMobilePhone" onkeyup="formatPhone(event)" class="textInput" value="'+(n.PersonMobilePhone!=null?n.PersonMobilePhone:"")+'"/></p><hr/></div>'+"</div>");$j("<button></button>").attr({value:"Save","data-inline":"true","class":"dialogbutton"}).click(function(e){showLoading(true);var t={};t.Primary_Email__pc=$j("#text-CustomerEmail").val()!=null&&$j("#text-CustomerEmail").val()!=""?$j("#text-CustomerEmail").val():null;t.Preferred_Method_of_Contact__pc=$j("#select-CustomerContactPhoneType").val()!=null&&$j("#select-CustomerContactPhoneType").val()!=""?$j("#select-CustomerContactPhoneType").val():null;t.Home_Phone__c=$j("#text-CustomerHomePhone").val()!=null&&$j("#text-CustomerHomePhone").val()!=""?$j("#text-CustomerHomePhone").val():null;t.Work_Phone__pc=$j("#text-CustomerWorkPhone").val()!=null&&$j("#text-CustomerWorkPhone").val()!=""?$j("#text-CustomerWorkPhone").val():null;t.PersonMobilePhone=$j("#text-CustomerMobilePhone").val()!=null&&$j("#text-CustomerMobilePhone").val()!=""?$j("#text-CustomerMobilePhone").val():null;t.Id=n.Id;modifyObject("customer","edit",null,t,function(){global_DialogId=n.Id;getObjectDetailDialogData(function(){$j("#objectdetailpagedialog").trigger("create");$j.mobile.loading("hide")})})}).appendTo("#dialogdetails")}$j("<button></button>").attr({value:"Cancel","data-inline":"true","class":"dialogbutton"}).click(function(t){showLoading(true);showObjectDetailDialogData(e,"display",function(){$j.mobile.changePage("#objectdetailpagedialog",{changeHash:true,transition:"none",allowSamePageTransition:true});$j("#objectdetailpagedialog").trigger("create");$j.mobile.loading("hide")})}).appendTo("#dialogdetails");$j("#dialogdetails").addClass("dialogdetaillines");$j("#objectdetailpagedialog").trigger("create")})}else{$j("#productsowned").empty();$j("#currentobjectdetailselection").text("");$j("#currentobjectdetailtitle").text("No Data Found")}if(n!=null){n()}}function getCustomerOpportunityData(e,t){if(e!=null&&e.length==1){var n=e[0].Id;MobileController.queryCustomerOpportunities(n,function(e,n){global_SelectedObject="Opportunities";showObjectDetailData(e,"Customer",0,t)},{escape:true})}}function getOpportunityCustomer(e,t){if(e!=null&&e.length==1){var n=e[0].AccountId;MobileController.queryOpportunityCustomer(n,function(e,n){global_SelectedObject="Customers";showObjectDetailDialogData(e,"display",t)},{escape:true})}}function eventKeyHandler(e){var t=e.keyCode?e.keyCode:e.charCode;if(t==13){if(event.target.id==="usersearch"){executeSearch()}else if(event.target.id==="casenumbersearch"||event.target.id==="caseownersearch"){showLoading(true);var n=function(){$j.mobile.changePage("#objectdetailpage",{changeHash:true});$j("#objectDetailListOrdered").listview("refresh");$j("#objectDetailListUnordered").listview("refresh");$j.mobile.loading("hide")};executeCaseSearch(n)}else if(event.target.id==="membernumbersearch"||event.target.id==="customernamesearch"){showLoading(true);var n=function(){$j.mobile.changePage("#objectdetailpage",{changeHash:true});$j("#objectDetailListOrdered").listview("refresh");$j("#objectDetailListUnordered").listview("refresh");$j.mobile.loading("hide")};executeCustomerSearch(n)}}}function formatPhone(e){var t=event.target.id;var n=/[0-9]{10}/;var r=/^\(?([0-9]{3})\)?[ ]?([0-9]{3})[-]?([0-9]{4}.*)$/;if($j("#"+t).val().length==10&&n.test($j("#"+t).val())){var i="("+$j("#"+t).val().substring(0,3)+") "+$j("#"+t).val().substring(3,6)+"-"+$j("#"+t).val().substring(6);$j("#"+t).val(i)}else if(r.test($j("#"+t).val())){var s=$j("#"+t).val().slice(0,14);$j("#"+t).val(s)}}function validDate(e){var t=/^(0?[1-9]|1?[012])[\/\-](0?[1-9]|[12][0-9]|3[01])[\/\-](20[123][0-9])$/;if(!t.test(e)){return false}return true}function executeSearch(){var e=null;var t=null;var n=$j("#usersearch").val();if(n!=null&&n!=""){MobileController.executeSearch(n,function(n,r){if(n!=null){e=n.Id}if($j("#radio-search-today").attr("checked")){t="TODAY"}else if($j("#radio-search-week").attr("checked")){t="LAST_N_DAYS:7"}else if($j("#radio-search-month").attr("checked")){t="LAST_N_DAYS:30"}var i=function(){$j.mobile.loading("hide")};showLoading(true);if(e==null){e="none";getGraphData(i,e,t)}else{getGraphData(i,e,t)}},{escape:true})}else{showLoading(true);var r=function(){$j.mobile.loading("hide")};getGraphData(r,e,t)}}function executeCaseSearch(e){var t=$j("#casenumbersearch").val();var n=$j("#caseownersearch").val();var r=null;if((t!=null||n!=null)&&(t!=""||n!="")){$j("#objectDetailListOrdered").empty();$j("#objectDetailListUnordered").empty();MobileController.executeCaseSearch(t,n,function(t,n){global_InitNextPage=0;global_InitPrevPage=-1;showObjectDetailData(t,r,0,e)},{escape:true})}else{records=null;global_InitNextPage=0;global_InitPrevPage=-1;showObjectDetailData(records,r,0,e)}}function executeCustomerSearch(e){var t=$j("#membernumbersearch").val();var n=$j("#customernamesearch").val();var r=null;if((t!=null||n!=null)&&(t!=""||n!="")){$j("#objectDetailListOrdered").empty();$j("#objectDetailListUnordered").empty();MobileController.executeCustomerSearch(t,n,function(t,n){global_InitNextPage=0;global_InitPrevPage=-1;showObjectDetailData(t,r,0,e)},{escape:true})}else{records=null;global_InitNextPage=0;global_InitPrevPage=-1;showObjectDetailData(records,r,0,e)}}function setConfirmationText(e,t){var n;switch(e){case"membership":n="Membership";break;case"auto":n="Auto";break;case"home":n="Homeowners";break;case"pup":n="Personal Umbrella (PUP)";break;default:n=null}$j("#confdialogdetails").empty();$j("#currentconfselection").text("New Lead");if(n!=null&&n!=""){$j("#currentconftitle").text("Create new "+n+" Lead for this Customer?");$j("<button>No</button>").attr({"data-role":"button","data-inline":"true","class":"confbutton"}).click(function(e){e.preventDefault();$j.mobile.changePage("#objectdetailpagedialog",{changeHash:true,transition:"pop",reverse:true})}).appendTo("#confdialogdetails");$j("<button>Yes</button>").attr({"data-role":"button","data-inline":"true","class":"confbutton"}).click(function(e){e.preventDefault();createPOILead(n,t)}).appendTo("#confdialogdetails")}else{$j("#currentconftitle").text("Create new Lead for this Customer?");$j("<button>No</button>").attr({"data-role":"button","data-inline":"true","class":"confbutton"}).click(function(e){e.preventDefault();$j.mobile.changePage("#objectdetailpagedialog",{changeHash:true,transition:"pop",reverse:true})}).appendTo("#confdialogdetails");$j("<button>Yes</button>").attr({"data-role":"button","data-inline":"true","class":"confbutton"}).click(function(e){e.preventDefault();createPOILead(null,t)}).appendTo("#confdialogdetails")}$j("#objectconfirmationdialog").trigger("create")}function createNewLead(e){if(global_PickListObject!=null){var t="";for(i=0;i<global_PickListObject.leadsPOIVals.length;i++){t=t+'<option value="'+global_PickListObject.leadsPOIVals[i]+'" >'+global_PickListObject.leadsPOIVals[i]+"</option>"}var n="";for(i=0;i<global_PickListObject.leadsStatus.length;i++){n=n+'<option value="'+global_PickListObject.leadsStatus[i]+'" >'+global_PickListObject.leadsStatus[i]+"</option>"}var r="";for(i=0;i<global_PickListObject.leadsCallBackPhoneType.length;i++){r=r+'<option value="'+global_PickListObject.leadsCallBackPhoneType[i]+'" >'+global_PickListObject.leadsCallBackPhoneType[i]+"</option>"}}refValue="Create New Lead";$j("#currentobjectdetailtitle").text(refValue);$j("#dialogdetails").html('<div data-role="collapsible-set" class="collapsibleContent">'+'<div data-role="collapsible" data-collapsed="false">'+"<h3>Lead Details</h3>"+'<p><label for="text-LeadFirstName" id="label-text-LeadFirstName">First Name:</label><input type="text" name="text-LeadFirstName" id="text-LeadFirstName" class="textInput" value=""/></p><hr/>'+'<p><label for="text-LeadLastName" id="label-text-LeadLastName">Last Name:</label><input type="text" name="text-LeadLastName" id="text-LeadLastName" class="textInput" value=""/></p><hr/>'+'<p><label for="select-LeadContactPhoneType" class="select" id="label-select-LeadContactPhoneType">Callback Phone Type:</label><select name="select-LeadContactPhoneType" id="select-LeadContactPhoneType" class="selectMenu">'+r+"</select></p><hr/>"+'<p><label for="text-LeadPhone" id="label-text-LeadPhone">Callback Phone:</label><input type="tel" name="text-LeadPhone" id="text-LeadPhone" class="textInput" onkeyup="formatPhone(event)" value=""/></p><hr/>'+'<p><label for="text-LeadEmail">Email:</label><input type="text" name="text-LeadEmail" id="text-LeadEmail" class="textInput" value=""/></p><hr/>'+'<p><label for="text-LeadStreet" id="label-text-LeadStreet">Street Address:</label><input type="text" name="text-LeadStreet" id="text-LeadStreet" class="textInput" value=""/></p><hr/>'+'<p><label for="text-LeadCity" id="label-text-LeadCity">City:</label><input type="text" name="text-LeadCity" id="text-LeadCity" class="textInput" value=""/></p><hr/>'+'<p><label for="text-LeadState" id="label-text-LeadState">State:</label><input type="text" name="text-LeadState" id="text-LeadState" class="textInput" value=""/></p><hr/>'+'<p><label for="text-LeadZip" id="label-text-LeadZip">Zip Code:</label><input type="tel" name="text-LeadZip" id="text-LeadZip" class="textInput" value=""/></p><hr/>'+'<p><label for="select-LeadPOI" class="select" id="label-select-LeadPOI">Product of Interest:</label><select name="select-LeadPOI" id="select-LeadPOI" class="selectMenu">'+t+"</select></p><hr/>"+'<p><label for="select-LeadStatus" class="select" id="label-select-LeadStatus">Lead Status:</label><select name="select-LeadStatus" id="select-LeadStatus" class="selectMenu">'+n+"</select></p><hr/></div>"+"</div>");$j("<button></button>").attr({value:"Save","data-inline":"true","class":"dialogbutton"}).click(function(e){showLoading(true);var t={};if($j("#text-LeadFirstName").val()==null||$j("#text-LeadFirstName").val()==""){$j("#label-text-LeadFirstName").css("color","red");$j("#label-text-LeadFirstName").text("First Name: *Required");$j("#text-LeadFirstName").focus();$j.mobile.loading("hide");return false}else{$j("#label-text-LeadFirstName").css("color","black");$j("#label-text-LeadFirstName").text("First Name:");t.FirstName=$j("#text-LeadFirstName").val()}if($j("#text-LeadLastName").val()==null||$j("#text-LeadLastName").val()==""){$j("#label-text-LeadLastName").css("color","red");$j("#label-text-LeadLastName").text("Last Name: *Required");$j("#text-LeadLastName").focus();$j.mobile.loading("hide");return false}else{$j("#label-text-LeadLastName").css("color","black");$j("#label-text-LeadLastName").text("Last Name:");t.LastName=$j("#text-LeadLastName").val()}if($j("#select-LeadContactPhoneType").val()==null||$j("#select-LeadContactPhoneType").val()==""){$j("#label-select-LeadContactPhoneType").css("color","red");$j("#label-select-LeadContactPhoneType").text("Callback Phone Type: *Required");$j("#select-LeadContactPhoneType").focus();$j.mobile.loading("hide");return false}else{$j("#label-select-LeadContactPhoneType").css("color","black");$j("#label-select-LeadContactPhoneType").text("Callback Phone Type:");t.Call_Back_Phone_Type__c=$j("#select-LeadContactPhoneType").val()}if($j("#text-LeadPhone").val()==null||$j("#text-LeadPhone").val()==""){$j("#label-text-LeadPhone").css("color","red");$j("#label-text-LeadPhone").text("Callback Phone: *Required");$j("#text-LeadPhone").focus();$j.mobile.loading("hide");return false}else{$j("#label-text-LeadPhone").css("color","black");$j("#label-text-LeadPhone").text("Callback Phone:");t.Phone=$j("#text-LeadPhone").val()}if($j("#text-LeadStreet").val()==null||$j("#text-LeadStreet").val()==""){$j("#label-text-LeadStreet").css("color","red");$j("#label-text-LeadStreet").text("Street Address: *Required");$j("#text-LeadStreet").focus();$j.mobile.loading("hide");return false}else{$j("#label-text-LeadStreet").css("color","black");$j("#label-text-LeadStreet").text("Street Address:");t.Street=$j("#text-LeadStreet").val()}if($j("#text-LeadCity").val()==null||$j("#text-LeadCity").val()==""){$j("#label-text-LeadCity").css("color","red");$j("#label-text-LeadCity").text("City: *Required");$j("#text-LeadCity").focus();$j.mobile.loading("hide");return false}else{$j("#label-text-LeadCity").css("color","black");$j("#label-text-LeadCity").text("City:");t.City=$j("#text-LeadCity").val()}if($j("#text-LeadState").val()==null||$j("#text-LeadState").val()==""||$j("#text-LeadState").val().length!=2){$j("#label-text-LeadState").css("color","red");$j("#label-text-LeadState").text("State: *Required");$j("#text-LeadState").focus();$j.mobile.loading("hide");return false}else{$j("#label-text-LeadState").css("color","black");$j("#label-text-LeadState").text("State:");t.State=$j("#text-LeadState").val()}if($j("#text-LeadZip").val()==null||$j("#text-LeadZip").val()==""||$j("#text-LeadZip").val().length!=5){$j("#label-text-LeadZip").css("color","red");$j("#label-text-LeadZip").text("Zip Code: *Required");$j("#text-LeadZip").focus();$j.mobile.loading("hide");return false}else{$j("#label-text-LeadZip").css("color","black");$j("#label-text-LeadZip").text("Zip Code:");t.PostalCode=$j("#text-LeadZip").val()}if($j("#select-LeadPOI").val()==null||$j("#select-LeadPOI").val()==""){$j("#label-text-LeadPOI").css("color","red");$j("#label-text-LeadPOI").text("Product of Interest: *Required");$j("#text-LeadPOI").focus();$j.mobile.loading("hide");return false}else{$j("#label-text-LeadPOI").css("color","black");$j("#label-text-LeadPOI").text("Product of Interest:");t.Product_of_Interest__c=$j("#select-LeadPOI").val()}if($j("#select-LeadStatus").val()==null||$j("#select-LeadStatus").val()==""){$j("#label-text-LeadStatus").css("color","red");$j("#label-text-LeadStatus").text("Lead Status: *Required");$j("#text-LeadStatus").focus();$j.mobile.loading("hide");return false}else{$j("#label-text-LeadStatus").css("color","black");$j("#label-text-LeadStatus").text("Lead Status:");t.Status=$j("#select-LeadStatus").val()}t.Email=$j("#text-LeadEmail").val()!=null&&$j("#text-LeadEmail").val()!=""?$j("#text-LeadEmail").val():null;MobileController.createLead(t,function(e,t){showObjectDetailDialogData(e,"display",function(){$j.mobile.changePage("#objectdetailpagedialog",{changeHash:true,transition:"none",allowSamePageTransition:true});$j("#objectdetailpagedialog").trigger("create");$j.mobile.loading("hide")})});return true}).appendTo("#dialogdetails");$j("<button></button>").attr({value:"Cancel","data-inline":"true","class":"dialogbutton"}).click(function(e){$j.mobile.changePage("#mainpage",{changeHash:true})}).appendTo("#dialogdetails");$j("#objectdetailpagedialog").trigger("create");if(e!=null){e()}}function createNewTask(e,t){var n;if(e!=null&&e!=""){$j(".ui-dialog-contain").css("margin","10% auto 30% auto");if(global_PickListObject!=null){var r="";for(i=0;i<global_PickListObject.tasksType.length;i++){r=r+'<option value="'+global_PickListObject.tasksType[i]+'" >'+global_PickListObject.tasksType[i]+"</option>"}var s="";for(i=0;i<global_PickListObject.tasksStatus.length;i++){s=s+'<option value="'+global_PickListObject.tasksStatus[i]+'" >'+global_PickListObject.tasksStatus[i]+"</option>"}var o="";for(i=0;i<global_PickListObject.tasksPriority.length;i++){o=o+'<option value="'+global_PickListObject.tasksPriority[i]+'" >'+global_PickListObject.tasksPriority[i]+"</option>"}}refValue="Create New Task";$j("#currentobjectdetailtitle").text(refValue);$j("#dialogdetails").html('<div data-role="collapsible-set" class="collapsibleContent">'+'<div data-role="collapsible" data-collapsed="false">'+"<h3>Task Details</h3>"+'<p><label for="text-TaskSubject" id="label-text-TaskSubject">Subject:</label><input type="text" name="text-TaskSubject" id="text-TaskSubject" class="textInput" value=""/></p><hr/>'+'<p><label for="select-TaskType" class="select" id="label-select-TaskType">Type:</label><select name="select-TaskType" id="select-TaskType" class="selectMenu">'+r+"</select></p><hr/>"+'<p><label for="select-TaskStatus" class="select" id="label-select-TaskStatus">Status:</label><select name="select-TaskStatus" id="select-TaskStatus" class="selectMenu">'+s+"</select></p><hr/>"+'<p><label for="select-TaskPriority" class="select" id="label-select-TaskPriority">Priority:</label><select name="select-TaskPriority" id="select-TaskPriority" class="selectMenu">'+o+"</select></p><hr/>"+'<p><label for="text-TaskDate" id="label-text-TaskDate">Due Date: (MM/DD/YYYY)</label><input type="text" name="text-TaskDate" id="text-TaskDate" class="textInput" maxlength="10" value=""/></p><hr/>'+'<p><label for="text-TaskDescription">Comments:</label><textarea name="text-TaskDescription" id="text-TaskDescription" class="textInput" value=""/></p><hr/></div>'+"</div>");$j("<button></button>").attr({value:"Save","data-inline":"true","class":"dialogbutton"}).click(function(t){showLoading(true);var r={};if($j("#text-TaskSubject").val()==null||$j("#text-TaskSubject").val()==""){$j("#label-text-TaskSubject").css("color","red");$j("#label-text-TaskSubject").text("Subject: *Required");$j("#text-TaskSubject").focus();$j.mobile.loading("hide");return false}else{$j("#label-text-TaskSubject").css("color","black");$j("#label-text-TaskSubject").text("Subject:");r.Subject=$j("#text-TaskSubject").val()}if($j("#select-TaskType").val()==null||$j("#select-TaskType").val()==""){$j("#label-select-TaskType").css("color","red");$j("#label-select-TaskType").text("Type: *Required");$j("#select-TaskType").focus();$j.mobile.loading("hide");return false}else{$j("#label-select-TaskType").css("color","black");$j("#label-select-TaskType").text("Type:");r.Type=$j("#select-TaskType").val()}if($j("#select-TaskStatus").val()==null||$j("#select-TaskStatus").val()==""){$j("#label-select-TaskStatus").css("color","red");$j("#label-select-TaskStatus").text("Status: *Required");$j("#select-TaskStatus").focus();$j.mobile.loading("hide");return false}else{$j("#label-select-TaskStatus").css("color","black");$j("#label-select-TaskStatus").text("Status:");r.Status=$j("#select-TaskStatus").val()}if($j("#select-TaskPriority").val()==null||$j("#select-TaskPriority").val()==""){$j("#label-select-TaskPriority").css("color","red");$j("#label-select-TaskPriority").text("Priority: *Required");$j("#select-TaskPriority").focus();$j.mobile.loading("hide");return false}else{$j("#label-select-TaskPriority").css("color","black");$j("#label-select-TaskPriority").text("Priority:");r.Priority=$j("#select-TaskPriority").val()}if(!validDate($j("#text-TaskDate").val())){$j("#label-text-TaskDate").css("color","red");$j("#label-text-TaskDate").text("Due Date: *Invalid Date, Required");$j("#text-TaskDate").focus();$j.mobile.loading("hide");return false}else{$j("#label-text-TaskDate").css("color","black");$j("#label-text-TaskDate").text("Date:");n=$j("#text-TaskDate").val()}r.Description=$j("#text-TaskDescription").val()!=null&&$j("#text-TaskDescription").val()!=""?$j("#text-TaskDescription").val():null;if(e.indexOf(LEAD)==0){r.WhoId=e}else if(e.indexOf(OPPTY)==0){r.WhatId=e}MobileController.createTask(n,r,function(e,t){global_SelectedObject="Tasks";showObjectDetailDialogData(e,"display",function(){$j.mobile.changePage("#objectdetailpagedialog",{changeHash:true,transition:"none",allowSamePageTransition:true});$j("#objectdetailpagedialog").trigger("create");$j.mobile.loading("hide")})});return true}).appendTo("#dialogdetails");$j("<button></button>").attr({value:"Cancel","data-inline":"true","class":"dialogbutton"}).click(function(e){$j.mobile.changePage("#mainpage",{changeHash:true})}).appendTo("#dialogdetails");$j("#objectdetailpagedialog").trigger("create");if(t!=null){t()}}else{return false}return true}function createPOILead(e,t){showLoading(true);showObjectOptions("Leads",function(){$j(".optionsbutton").button();$j(".optionsbutton").button("refresh")});var n=function(){getObjectDetailData(function(){$j(".collapsibleContent").collapsibleset();$j(".collapsibleContent").collapsibleset("refresh");$j("#objectDetailListOrdered").listview("refresh");$j("#objectDetailListUnordered").listview("refresh")});$j.mobile.changePage("#objectdetailpagedialog",{changeHash:true});$j.mobile.loading("hide")};MobileController.createPOIObject("Leads",t,e,function(e,t){if(t.type!="exception"&&e!=null&&e.length>0){showObjectDetailDialogData(e,"display",n)}else{$j.mobile.changePage("#objectdetailpagedialog",{changeHash:true});$j("#productsowned").empty();$j("#currentobjectdetailselection").text("");$j("#currentobjectdetailtitle").text("We're sorry!");$j("#dialogdetails").html("<p>An unexpected error has occured, the Lead was not created.</p>"+"<p>Error Message: "+t.message+"</p>");$j("#dialogdetails").addClass("dialogdetaillines");$j.mobile.loading("hide")}},{escape:true})}function modifyObject(e,t,n,r,i){if(e=="task"){MobileController.updateTask(n,r,function(e,t){if(i!=null){i()}},{escape:true})}else{MobileController.modifyObject(e,t,r,function(e,n){$j("#currentconfselection").text("");$j("#currentconftitle").text("");if(e!=null&&e){switch(t){case"convert":$j("#confdialogdetails").html('<p style="font-weight:bold;">Lead converted successfully!</p>');$j("<button></button>").attr({value:"View Opportunities","class":"confbutton"}).click(function(e){global_SelectedObject="Opportunities";showLoading(true);getObjectDetailData(function(e){$j.mobile.changePage("#objectdetailpage",{changeHash:true});$j("#objectDetailListOrdered").listview("refresh");$j("#objectDetailListUnordered").listview("refresh");$j.mobile.loading("hide")})}).appendTo("#confdialogdetails");$j("#configdialogclosebutton").attr("href","#objectdetailpage");break;case"delete":$j("#confdialogdetails").html('<p style="font-weight:bold;">Lead deleted successfully!</p>');$j("<button></button>").attr({value:"Return to My Leads","class":"confbutton"}).click(function(e){global_SelectedObject="Leads";showLoading(true);getObjectDetailData(function(e){$j.mobile.changePage("#objectdetailpage",{changeHash:true});$j("#objectDetailListOrdered").listview("refresh");$j("#objectDetailListUnordered").listview("refresh");$j.mobile.loading("hide")})}).appendTo("#confdialogdetails");$j("#configdialogclosebutton").attr("href","#objectdetailpage");break}if(i!=null){i()}}else{if(t!=null&&t=="convert"){$j("#confdialogdetails").html('<p style="font-weight:bold;">Lead conversion failed!</p>')}else if(t!=null&&t=="delete"){$j("#confdialogdetails").html('<p style="font-weight:bold;">Lead delete failed!</p>')}else{$j("#confdialogdetails").html('<p style="font-weight:bold;">Edit failed!</p>')}$j("<button></button>").attr({value:"Return to My Leads","class":"confbutton"}).click(function(e){global_SelectedObject="Leads";showLoading(true);getObjectDetailData(function(e){$j.mobile.changePage("#objectdetailpage",{changeHash:true});$j("#objectDetailListOrdered").listview("refresh");$j("#objectDetailListUnordered").listview("refresh");$j.mobile.loading("hide")})}).appendTo("#confdialogdetails");$j("#configdialogclosebutton").attr("href","#objectdetailpage");if(i!=null){i()}}$j(".confbutton").button();$j(".confbutton").button("refresh")},{escape:true})}}function paginate(e,t){if(e.length>PAGE_LENGTH){$j("#nextButton").removeAttr("disabled");$j(".detailbutton").button();$j(".detailbutton").button("refresh")}$j("#nextButton").unbind("click");$j("#nextButton").click(function(n){var r=String(e.length);var i=r.charAt(0);var s=r.charAt(1)!=null?r.charAt(1):null;if(global_InitNextPage+1==parseInt(i)||global_InitNextPage+2==parseInt(i)&&s!=null&&parseInt(s)==0){showLoading(true);global_InitNextPage++;showObjectDetailData(e,t,global_InitNextPage,function(e){$j.mobile.changePage("#objectdetailpage",{changeHash:true,transition:"none",allowSamePageTransition:true});$j("#objectDetailListOrdered").listview("refresh");$j("#objectDetailListUnordered").listview("refresh");$j("#nextButton").attr({disabled:"true"});$j(".detailbutton").button();$j(".detailbutton").button("refresh");global_InitPrevPage++;$j.mobile.loading("hide")})}else{$j("#nextButton").removeAttr("disabled");$j(".detailbutton").button();$j(".detailbutton").button("refresh");showLoading(true);global_InitNextPage++;showObjectDetailData(e,t,global_InitNextPage,function(e){$j.mobile.changePage("#objectdetailpage",{changeHash:true,transition:"none",allowSamePageTransition:true});$j("#objectDetailListOrdered").listview("refresh");$j("#objectDetailListUnordered").listview("refresh");global_InitPrevPage++;$j.mobile.loading("hide")})}if(global_InitNextPage>0){$j("#prevButton").unbind("click");$j("#prevButton").removeAttr("disabled");$j(".detailbutton").button();$j(".detailbutton").button("refresh");$j("#prevButton").click(function(n){showLoading(true);showObjectDetailData(e,t,global_InitPrevPage,function(e){$j.mobile.changePage("#objectdetailpage",{changeHash:true,transition:"none",allowSamePageTransition:true});$j("#objectDetailListOrdered").listview("refresh");$j("#objectDetailListUnordered").listview("refresh");global_InitNextPage--;global_InitPrevPage--;if(global_InitNextPage<1){$j("#prevButton").attr({disabled:"true"})}$j(".detailbutton").button();$j(".detailbutton").button("refresh");$j.mobile.loading("hide")})})}})}function disablePageButtons(){$j("#prevButton").attr({disabled:"true"});$j("#nextButton").attr({disabled:"true"});$j(".detailbutton").button();$j(".detailbutton").button("refresh")}var global_DialogId;var global_SelectedObject;var global_InitNextPage=0;var global_InitPrevPage=-1;var global_PickListObject=null;var global_NotificationsHaveRun=false;var EMPTY_VAL="Not Available";var LEAD="00Q";var OPPTY="006";var TASK="00T";var CASE="500";var CUST="001";var AUTO=0;var HOMEOWNERS=1;var LIFE=2;var MEMBERSHIP=3;var EARTHQUAKE=4;var PAGE_LENGTH=10;var $j=jQuery.noConflict();$j(document).on("pageinit",function(){setTimeout(function(e){hideAddressBar()},150);$j(document).on("pageshow",function(){var e=$j.mobile.activePage.attr("id");if((global_SelectedObject==null||global_SelectedObject=="")&&e!=null&&e!="mainpage"){setTimeout(function(e){$j.mobile.changePage("#mainpage",{changeHash:true,transition:"slide",reverse:true})},150)}else if(e=="mainpage"){showLoading(true);initGlobals();$j("#configdialogclosebutton").attr("href","#");showSalesOptions(function(){$j("#mainpage").trigger("create");$j("#saleslist").show();if(!global_NotificationsHaveRun){getNotifications(function(){$j("#mainpage").trigger("create")});global_NotificationsHaveRun=true}$j.mobile.loading("hide")})}else if(e!="objectdetailpagedialog"){$j(".ui-dialog-contain").css("margin","10% auto 15px auto")}})});$j(window).bind("orientationchange",function(e){setTimeout(function(e){hideAddressBar()},150);if($j.mobile.activePage.attr("id")==="graphpage"){if($j("#usersearch").val()!=null&&$j("#usersearch").val()!=""){executeSearch()}else{showLoading(true);$j.mobile.changePage("#graphpage",{changeHash:true,transition:"none",allowSamePageTransition:true});getGraphData(function(){$j.mobile.loading("hide")},null,null)}}});$j("input").live("focus",function(e){e.preventDefault();e.stopPropagation();var t=$j("#"+e.target.id).offset().top;window.scrollTo(window.pageXOffset,t-30)});$j("textarea").live("focus",function(e){e.preventDefault();e.stopPropagation();var t=$j("#"+e.target.id).offset().top;window.scrollTo(window.pageXOffset,t-30)});$j(document).on("pageinit","#mainpage",function(){$j(document).on("swipeleft swiperight","#mainpage",function(e){if($j.mobile.activePage.jqmData("panel")!=="open"){if(e.type==="swipeleft"){$j("#popupPanel").panel("open")}else if(e.type==="swiperight"){$j("#popupPanel").panel("close")}}})});$j(document).on("swiperight","#optionspage",function(){$j.mobile.changePage("#mainpage",{changeHash:true,transition:"slide",reverse:true})});$j(document).on("swiperight","#objectdetailpage",function(){$j.mobile.changePage("#optionspage",{changeHash:true,transition:"slide",reverse:true})});$j(document).on("swiperight","#graphpage",function(){$j.mobile.changePage("#optionspage",{changeHash:true,transition:"slide",reverse:true})});$j(document).on("swiperight","#objectdetailpagedialog",function(){if($j("#currentobjectoptionselection").text()===global_SelectedObject){$j.mobile.changePage("#objectdetailpage",{changeHash:true,transition:"pop",reverse:true})}else{$j.mobile.changePage("#mainpage",{changeHash:true,transition:"pop",reverse:true})}});$j("#chartdiv").live("jqplotDataClick",function(e,t,n,r){var i;var s;if(n===AUTO){s="Auto"}else if(n===HOMEOWNERS){s="Homeowners"}else if(n===LIFE){s="Life"}else if(n===MEMBERSHIP){s="Membership"}else if(n===EARTHQUAKE){s="Earthquake"}if($j("#usersearch").val()!=null&&$j("#usersearch").val()!=""){i=$j("#usersearch").val();MobileController.executeSearch(i,function(e,t){i=e!=null?e.Id:null;showLoading(true);getGraphObjectDetailData(function(){$j.mobile.changePage("#objectdetailpage",{changeHash:true});$j("#objectDetailListOrdered").listview("refresh");$j("#objectDetailListUnordered").listview("refresh");$j.mobile.loading("hide")},s,i)})}else{MobileController.getCurrentUser(function(e,t){i=e!=null?e:null;showLoading(true);getGraphObjectDetailData(function(){$j.mobile.changePage("#objectdetailpage",{changeHash:true});$j("#objectDetailListOrdered").listview("refresh");$j("#objectDetailListUnordered").listview("refresh");$j.mobile.loading("hide")},s,i)})}})